<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
        <template id="document_format_zoopet.report_invoice_not_use_document">
            <t t-name="document_format_zoopet.report_invoice_not_use_document">
                <t t-call="web.external_layout">
                    <div class="page">
                    <t t-set="not_use_invoice" t-value="1"/>
                    <t t-set="doc_name" t-value="o.number" />
                    <t t-set="isInvoice" t-value="o.type" />
                    <t t-set="delivery_method" t-value="o.delivery_method" />
                    <t t-if="isInvoice == 'out_invoice'">
                        <t t-set="lumps_number" t-value="o.lumps_number" />
                        <t t-set="palets_number" t-value="o.palets_number" />
                    </t>
                    <t t-set="mostrarFrasePortes" t-value="False" />
                    <t t-foreach="o.invoice_line_ids" t-as="line">
                        <t t-if="line.price_unit &gt; 0.00">
                            <t t-if="line.product_id.type == 'service'">
                                <t t-set="mostrarFrasePortes" t-value="True" />
                            </t>
                        </t>
                    </t>
                    <t t-set="serieInv" t-value="o.sale_type_id.name" />
                    <!-- Buscamos el tipo en el number de la rectificativa -->
                    <t t-set="isRecT" t-value="doc_name.find('T')" />
				    <t t-set="isRecP" t-value="doc_name.find('P')" />
                    <!-- Fin buscamos el tipo en el number de la rectificativa -->
                    <!-- Datos del docuumento -->
                    <!-- si tiene copias -->
                    <t t-if="iteration">
                        <t t-set="inv_copy" t-value="iteration" />
                        <t t-if="iteration &lt; 2">
                        </t>
                        <t t-else="">
                            <div style="display:block;width:100%;clear:both;text-align:right;">
                                <b>
                                    <span>
                                        Copia
                                    </span>
                                    <span t-esc="iteration -1">
                                    </span>
                                </b>
                            </div>
                        </t>
                    </t>
                    <!-- si tiene copias -->
                    <!-- Direcciones -->
                    <!-- DIreccion de facturacion -->
                    <div style="width:49%;float:left;clear:both;margin-right:1%;border:2px solid black;height:223px;">
                        <div style="background-color:blue;color:white;text-align:center;">
                            Dirección de facturacíon
                        </div>
                        <div t-if="o.partner_id" style="margin-left:2%;">
                            <!-- nombre -->
                            <t t-set="partner_id" t-value="o.partner_id" />
                            <t t-if="partner_id.parent_id">
                                <t t-set="partner_id" t-value="o.partner_id.parent_id" />
                            </t>
                            <div t-if="partner_id.name">
                                <t t-set="partner_name" t-value="partner_id.name"/>
							    <t t-set="partner_num" t-value="partner_name.find('(') - 1 " />
                                <t t-if="partner_num &gt; 0">
								    <t t-set="partner_name" t-value="partner_name[:partner_num]" />
							    </t>
							    <span t-esc="partner_name" />
                            </div>
                            <!-- nombre comercial -->
                            <div t-if="partner_id.comercial">
                                <span t-field="o.partner_id.comercial" />
                            </div>
                            <!-- calle -->
                            <div>
                                <span t-field="o.partner_id.street" />
                            </div>
                            <!-- calle 2 -->
                            <div>
                                <span t-field="o.partner_id.street2" />
                            </div>
                            <!-- CP, ciudad -->
                            <div>
                                <span t-if="o.partner_id.zip" t-field="o.partner_id.zip" />
                                <span t-if="o.partner_id.city" t-field="o.partner_id.city" />
                            </div>
                            <!-- Provincia -->
                            <div>
                                <span t-if="o.partner_id.state_id.name" t-field="o.partner_id.state_id.name" />
                            </div>
                            <!-- tlf -->
                            <div>
                                <span t-if="o.partner_id.phone">
                                    TLF.:
                                </span>
                                <span t-if="o.partner_id.phone" t-field="o.partner_id.phone" />
                                <span t-if="o.partner_id.mobile">, </span><span t-if="o.partner_id.mobile" t-field="o.partner_id.mobile"/>
                            </div>
                            <!-- CIF/NIF -->
                            <div>
                                <span t-if="o.partner_id.vat">
                                    NIF/CIF:
                                </span>
                                <span t-if="o.partner_id.vat" t-field="o.partner_id.vat" />
                            </div>
                            <!-- Nota -->
                            <t t-if="o.partner_id.parent_id">
                                <div t-if="o.partner_id.comment">
                                    <span>
                                        Nota:
                                    </span>
                                    <span t-field="o.partner_id.comment" />
                                </div>
                            </t>
                        </div>
                    </div>
                    <!-- Fin direccion de facturacion -->
                    <!-- Direccion de envio -->
                    <div style="width:49%;float:left;border:2px solid black;margin-left:1%;height:223px;">
                        <div style="background-color:blue;color:white;text-align:center;">
                            Dirección de envío
                        </div>
                        <div t-if="o.partner_id" style="margin-left:2%;">
                            <!-- nombre -->
                            <t t-set="partner_id" t-value="o.partner_id" />
                            <t t-if="partner_id.parent_id">
                                <t t-set="partner_id" t-value="o.partner_id.parent_id" />
                            </t>
                            <div t-if="partner_id.name">
                                <t t-set="partner_name" t-value="partner_id.name"/>
							    <t t-set="partner_num" t-value="partner_name.find('(') - 1 " />
                                <t t-if="partner_num &gt; 0">
								    <t t-set="partner_name" t-value="partner_name[:partner_num]" />
							    </t>
							    <span t-esc="partner_name" />
                            </div>
                            <!-- nombre comercial -->
                            <div t-if="partner_id.comercial">
                                <span t-field="partner_id.comercial" />
                            </div>
                            <!-- calle -->
                            <div>
                                <span t-field="o.partner_shipping_id.street" />
                            </div>
                            <!-- calle 2 -->
                            <div>
                                <span t-field="o.partner_shipping_id.street2" />
                            </div>
                            <!-- CP, ciudad -->
                            <div>
                                <span t-if="o.partner_shipping_id.zip" t-field="o.partner_shipping_id.zip" />
                                <span t-if="o.partner_shipping_id.city" t-field="o.partner_shipping_id.city" />
                            </div>
                            <!-- Provincia -->
                            <div>
                                <span t-if="o.partner_shipping_id.state_id.name" t-field="o.partner_shipping_id.state_id.name" />
                            </div>
                            <!-- tlf -->
                            <div>
                                <span t-if="o.partner_shipping_id.phone">
                                    TLF.:
                                </span>
                                <span t-if="o.partner_shipping_id.phone" t-field="o.partner_shipping_id.phone" />
                                 <span t-if="o.partner_shipping_id.mobile">, </span><span t-if="o.partner_shipping_id.mobile" t-field="o.partner_shipping_id.mobile"/>
                            </div>
                            <!-- Nota -->
                            <t t-if="o.partner_id != o.partner_shipping_id">
                                <div t-if="o.partner_shipping_id.comment">
                                    <span>
                                        Nota:
                                    </span>
                                    <span t-field="o.partner_shipping_id.comment" />
                                </div>
                            </t>
                        </div>
                    </div>
                    <!-- Fin direccion de envio -->
                    <!-- Fin direcciones -->
                    <!-- datos documento -->
                    <div style="width:49%;clear:both;float:left;margin-right:1%;margin-top:5px;font-size:0.9em;margin-bottom:5px;">
                        <div style="width:50%;float:left;border:2px solid black;height:25px;">
                            <span style="margin-left:2px;">
								<t t-if="isInvoice == 'out_invoice'">

										<b><span style="font-size:0.8em;">
											Factura:
										</span></b>


								</t>
								<t t-else="isInvoice == 'out_refund'">

											<b><span style="font-size:0.8em;">
												Rectificativa:
											</span></b>

								</t>
							</span>
                            <span t-field="o.number" />
                        </div>
                        <div style="width:50%;float:left;border-bottom:2px solid black;border-right:2px solid black;border-top:2px solid black;height:25px;">
                            <span style="margin-left:2px;">
                                <b>
                                    Fecha:
                                </b>
                            </span>
                            <span t-field="o.create_date" t-options="{&quot;format&quot;: &quot;dd/MM/yyyy&quot;}" />
                        </div>
                        <div style="width:50%;float:left;border-bottom:2px solid black;border-left:2px solid black;border-right:2px solid black;height:25px;">
                            <span style="margin-left:2px;">
                                <b>
                                    Cliente:
                                </b>
                            </span>
                            <span t-if="o.partner_id.parent_id" t-field="o.partner_id.parent_id.ref" />
                            <span t-if=" not o.partner_id.parent_id" t-field="o.partner_id.ref" />
                        </div>
                        <div style="width:50%;float:left;border-bottom:2px solid black;border-right:2px solid black;height:25px;">
                            <t t-set="origin_label" t-value="'Pedido: '" />
                            <t t-if="isInvoice == 'out_refund'">
                                <t t-set="origin_label" t-value="'Referencia :'" />
                                <t t-if="not o.refund_invoice_id">
                                    <t t-set="name_with_type" t-value="o.refund_invoice_name" />
                                </t>
                                <t t-else="">
                                    <t t-set="name_with_type" t-value="o.origin" />
                                </t>
                            </t>
                            <t t-else="">
                                <t t-set="name_with_type" t-value="o.sale_type_id.journal_id.code + '/' + o.origin" />
                            </t>
                            <t t-set="origin_num" t-value="name_with_type.find(',')"/>
								<t t-if="origin_num &gt; 0">
								</t>
								<t t-else="">
									<b>
									<span style="margin-left:2px;" t-esc="origin_label" />
									</b>
									<span t-esc="name_with_type" />
								</t>
                        </div>
                    </div>
                    <!-- fin datos documento -->
                    <!-- observaciones -->
                    <div style="width:49%;float:left;margin-left:1%;border:2px solid black;height:51px;margin-top:5px;">
                        <t t-if="isInvoice == 'out_refund'">
                            <div>
                                <span style="margin-left:2px;">
                                    <b>
                                        Mótivo:
                                    </b>
                                </span>
                                <t t-if="not o.refund_invoice_id">
                                    <span>Devolución</span>
                                </t>
                                <t t-else="">
                                    <span t-field="o.name" />
                                </t>
                            </div>
                        </t>
                        <span style="margin-left:2px;">
                            <b>
                                Observaciones:
                            </b>
                        </span>
                        <span t-field="o.comment" />
                    </div>
                    <!-- fin observaciones -->
                    <!-- Fin datos documento -->
                    <!-- Datos del cliente -->
                    <div id="informations" class="row mt32 mb32" style="display:none;">
                        <div class="col-auto mw-100 mb-2" t-if="o.name" name="description">
                            <strong>
                                Description:
                            </strong>
                            <p class="m-0" t-field="o.name" />
                        </div>
                        <div class="col-auto mw-100 mb-2" t-if="o.date_invoice" name="invoice_date">
                            <strong>
                                Invoice Date:
                            </strong>
                            <p class="m-0" t-field="o.date_invoice" />
                        </div>
                        <div class="col-auto mw-100 mb-2" t-if="o.date_due and o.type == 'out_invoice' and o.state in ('open', 'in_payment', 'paid')" name="due_date">
                            <strong>
                                Due Date:
                            </strong>
                            <p class="m-0" t-field="o.date_due" />
                        </div>
                        <div class="col-auto mw-100 mb-2" t-if="o.origin" name="origin">
                            <strong>
                                Source:
                            </strong>
                            <p class="m-0" t-field="o.origin" />
                        </div>
                        <div class="col-auto mw-100 mb-2" t-if="o.partner_id.ref" name="customer_code">
                            <strong>
                                Customer Code:
                            </strong>
                            <p class="m-0" t-field="o.partner_id.ref" />
                        </div>
                        <div name="reference" class="col-auto mw-100 mb-2" t-if="o.reference">
                            <strong>
                                Reference:
                            </strong>
                            <p class="m-0" t-field="o.reference" />
                        </div>
                    </div>
                    <!-- Datos del documento -->
                    <div style="width:50%;float:left;margin-top:-115px;margin-bottom:15px;display:none;">
                        <h2 style="padding-top:30px;margin-left:50px;">
                            <span t-if="o.type == 'out_invoice' and o.state in ('open', 'in_payment', 'paid')">
                                Invoice
                            </span>
                            <span t-if="o.type == 'out_invoice' and o.state == 'draft'">
                                Draft Invoice
                            </span>
                            <span t-if="o.type == 'out_invoice' and o.state == 'cancel'">
                                Cancelled Invoice
                            </span>
                            <span t-if="o.type == 'out_refund'">
                                Credit Note
                            </span>
                            <span t-if="o.type == 'in_refund'">
                                Vendor Credit Note
                            </span>
                            <span t-if="o.type == 'in_invoice'">
                                Vendor Bill
                            </span>
                        </h2>
                        <span style="width:20%;display:inline-block">
                            Número:
                        </span>
                        <span style="display:inline-block;width:80%;" t-field="o.number" />
                        <span style="width:20%;display:inline-block">
                            Fecha:
                        </span>
                        <span style="display:inline-block;width:80%;" t-field="o.date_invoice" t-options="{&quot;format&quot;: &quot;MM-dd-yyyy&quot;}" />
                        <div t-if="o.origin">
                            <span style="width:20%;display:inline-block">
                                Pedido:
                            </span>
                            <span style="display:inline-block;width:80%;" t-field="o.origin" />
                        </div>
                        <div t-if="o.partner_id.comercial">
                            <span style="width:20%;display:inline-block">
                                Cliente:
                            </span>
                            <span style="display:inline-block;width:80%;" t-field="o.partner_id.comercial" />
                        </div>
                        <div t-else="">
                            <span style="width:20%;display:inline-block">
                                Cliente:
                            </span>
                            <span style="display:inline-block;width:80%;" t-field="o.partner_id.name" />
                        </div>
                        <div t-if="o.partner_id.vat">
                            <span style="width:20%;display:inline-block">
                                NIF/CIF:
                            </span>
                            <span style="display:inline-block;width:80%;" t-field="o.partner_id.vat" />
                        </div>
                    </div>
                    <!-- Descuentos -->
                    <t t-set="total_discount1" t-value="0" />
                    <t t-set="total_discount3" t-value="0" />
                    <t t-set="delivery" t-value="0" />
                    <t t-foreach="o.invoice_line_ids" t-as="line">
                        <t t-set="line_discount1" t-value="0" />
                        <t t-set="unit_price" t-value="line.price_unit" />
                        <t t-if="line.product_id">
                            <t t-if="line.discount != 0">
                                <t t-set="line_discount1" t-value="unit_price * line.discount / 100 * line.quantity" />
                                <t t-set="unit_price" t-value="unit_price - (unit_price * line.discount / 100)" />
                            </t>
                            <t t-if="line_discount1 != 0">
                                <t t-set="total_discount1" t-value="total_discount1 + line_discount1" />
                            </t>
                        </t>
                    </t>
                    <!-- fin descuentos -->
                    <!-- Fin datos documento -->
                    <t t-set="display_discount" t-value="any([l.discount for l in o.invoice_line_ids])" />
                    <!-- lineas -->
                    <table class="table">
                        <thead>
                            <tr style="border-top:4px solid black;">
                                <th style="padding:0px;margin:0px;font-size:0.7em;border-bottom:2px solid black;">
                                    <div style="clear:both;color:black;">
                                        <div style="width:10%;display:block;float:left;">
                                            <span>
                                                <b>
                                                    Código
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:38%;display:block;float:left;">
                                            <span>
                                                <b>
                                                    Descripción
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:7%;display:block;float:left;text-align:right;">
                                            <span>
                                                <b>
                                                    IVA%
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:10%;display:block;float:left;text-align:right;">
                                            <span>
                                                <b>
                                                    Unds
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:9%;display:block;float:left;text-align:right;">
                                            <span>
                                                <b>
                                                    Precio/U
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:8%;display:block;float:left;text-align:right;">
                                            <t t-if="total_discount1 != 0">
                                                <span>
                                                    <b>
                                                        Desc.%
                                                    </b>
                                                </span>
                                            </t>
                                            <t t-else="">
                                                <span style="color:white;">
                                                    <b>
                                                        Desc.%
                                                    </b>
                                                </span>
                                            </t>
                                        </div>
                                        <div style="width:8%;display:block;float:left;text-align:right;">
                                            <span>
                                                <b>
                                                    Neto
                                                </b>
                                            </span>
                                        </div>
                                        <div style="width:10%;display:block;float:left;text-align:right;">
                                            <span>
                                                <b>
                                                    Importe
                                                </b>
                                            </span>
                                        </div>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <!-- <hr style="height:2px;width:99.6%;background-color:black;margin-top:-5px;"/> -->
                        <!-- marca de agua -->
                        <div class="watermark" style="position:absolute;opacity:0.25;font-size:3em;width:100%;text-align:center;z-index:1000;-webkit-transform: rotate(-37deg);margin-top:450px;">
                            <t t-if="isInvoice == 'out_invoice'">
                                <p>
                                    *FACTURA*
                                </p>
                            </t>
                            <t t-if="isInvoice == 'out_refund'">
                                <p>
                                    *NOTA DE CREDITO*
                                </p>
                            </t>
                        </div>
                        <!-- fin marca de agua -->
                        <!-- Variables -->
                        <t t-set="current_subtotal" t-value="0" />
                        <t t-set="current_discount" t-value="0" />
                        <t t-set="current_bruto" t-value="0" />
                        <t t-set="lineas" t-value="0" />
                        <t t-set="portes" t-value="0" />
                        <t t-set="importeIva21" t-value="0" />
                        <t t-set="importeRec52" t-value="0" />
                        <t t-set="importeIva21Total" t-value="0" />
                        <t t-set="importeRec52Total" t-value="0" />
                        <t t-set="importeIva10" t-value="0" />
                        <t t-set="importeRec14" t-value="0" />
                        <t t-set="importeIva10Total" t-value="0" />
                        <t t-set="importeRec14Total" t-value="0" />
                        <t t-set="importeIva4" t-value="0" />
                        <t t-set="importeRec05" t-value="0" />
                        <t t-set="importeIva4Total" t-value="0" />
                        <t t-set="importeRec05Total" t-value="0" />
                        <t t-set="weight" t-value="0" />
                        <!-- Fin variables -->
                        <tbody class="sale_tbody" style="border-bottom:4px solid black;">
                            <t t-foreach="o.invoice_line_ids" t-as="line">
                                <tr>
                                    <td style="padding:0px;margin:0px;border:none;">
                                        <!-- calculo peso -->
                                        <t t-if="line.product_id.weight">
                                            <t t-set="weight" t-value="weight + line.product_id.weight * line.quantity" />
                                        </t>
                                        <!-- fin calculo peso -->
                                        <t t-set="productName" t-value="line.product_id.name" />
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded" />
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included" />
                                        <!-- calculos del descuento -->
                                        <t t-set="current_discount" t-value="current_discount + (line.quantity * line.price_unit) - line.price_subtotal" groups="sale.group_discount_per_so_line" />
                                        <!-- Fin calculos del descuento -->
                                        <!-- Calculos del bruto -->
                                        <t t-set="current_bruto" t-value="current_bruto + (line.quantity * line.price_unit)" groups="account.group_show_line_subtotals_tax_excluded" />
                                        <!-- Fin calculos del bruto -->
                                        <!-- fin si es entrega -->
                                        <!-- Si es nota -->
                                        <t t-if="not line.product_id">
                                            <div class="text-left" style="font-size:0.7em;">
                                                <span style="margin-left:15px;">
                                                    NOTA:
                                                </span>
                                                <span t-field="line.name" />
                                            </div>
                                        </t>
                                        <!-- Fin si es nota -->
                                        <t t-if="line.product_id">
                                            <!-- verificar que no sea portes = 0€ -->
                                            <t t-set="mostrar" t-value="True" />
                                            <t t-if="line.price_unit &lt; 0.01">
                                                <t t-if="line.product_id.type == 'service'">
                                                    <t t-set="mostrar" t-value="False" />
                                                </t>
                                            </t>
                                            <!-- verificar que no sea portes = 0€ -->
                                            <t t-if="mostrar == True">
                                                <div style="font-size:0.7em;clear:both;">
                                                    <!-- codigo -->
                                                    <div style="width:10%;display:block;float:left;">
                                                        <t t-if="line.product_id.default_code">
                                                            <span t-field="line.product_id.default_code" />
                                                        </t>
                                                        <t t-else="">
                                                            <span style="color:white;">
                                                                abc
                                                            </span>
                                                        </t>
                                                    </div>
                                                    <!-- Fin codigo -->
                                                    <!-- Descripcion -->
                                                    <div style="width:38%;display:block;float:left;">
                                                        <t t-if="line.name">
                                                            <t t-set="productName" t-value="line.name" />
                                                            <t t-set="name_num" t-value="productName.find(']') + 1 " />
                                                            <t t-set="name" t-value="productName[name_num:]" />
                                                            <span t-esc="name" />
                                                        </t>
                                                        <t t-else="">
                                                            <span style="color:white;">
                                                                abc
                                                            </span>
                                                        </t>
                                                    </div>
                                                    <!-- Fin descripcion -->
                                                    <!-- % de IVA -->
                                                    <div style="width:7%;display:block;float:left;text-align:right;">
                                                        <t t-if="o.sale_type_id.name == 'Serie C'">
                                                            <span style="color:white;">
                                                                abc
                                                            </span>
                                                        </t>
                                                        <t t-else="">
                                                            <t t-set="IVALin" t-value="0" />
                                                            <t t-foreach="line.invoice_line_tax_ids" t-as="tax">
                                                                <t t-set="tax_name" t-value="tax.name" />
                                                                <t t-set="isIVA" t-value="tax_name.find('IVA')" />
                                                                <t t-if="isIVA &gt; -1">
                                                                    <span t-esc="'%.2f'%tax.amount" />
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="not line.invoice_line_tax_ids">
                                                            <span style="color:white;">
                                                                abc
                                                            </span>
                                                        </t>
                                                    </div>
                                                    <!-- Fin % de IVA -->
                                                    <!-- Cantidad entregada -->
                                                    <div style="width:10%;display:block;float:left;text-align:right">
                                                        <span t-esc="'%.2f'%line.quantity" />
                                                    </div>
                                                    <!-- Fin cantidad entregada -->
                                                    <!-- Precio / U -->
                                                    <div style="width:9%;display:block;float:left;text-align:right;">
                                                        <span t-field="line.price_unit" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                    </div>
                                                    <!-- Fin precio / u -->
                                                    <!-- Descuento -->
                                                    <div t-if="line.discount != 0.00" style="width:8%;display:block;float:left;text-align:right;">
                                                        <t t-if="line.discount != 0.00">
                                                            <span t-field="line.discount" />
                                                        </t>
                                                        <t t-else="">
                                                            <span style="color:white;">
                                                                abc
                                                            </span>
                                                        </t>
                                                    </div>
                                                    <div t-else="" style="width:8%;display:block;float:left;text-align:right;">
                                                        <span style="color:white;">
                                                            abc
                                                        </span>
                                                    </div>
                                                    <!-- Fin descuento -->
                                                    <!-- Precio Neto / u -->
                                                    <div style="width:8%;display:block;float:left;text-align:right;">
                                                        <t t-set="neto_linea" t-value="line.price_unit" />
                                                        <t t-if="line.discount != 0.00">
                                                            <t t-set="neto_linea" t-value="neto_linea - (neto_linea * line.discount /100)" />
                                                        </t>
                                                        <span t-esc="neto_linea" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                    </div>
                                                    <!-- Fin precio neto / u -->
                                                    <!-- Precio total linea -->
                                                    <div style="width:10%;display:block;float:left;text-align:right;">
                                                        <t t-set="total_linea" t-value="neto_linea * line.quantity" />
                                                        <span t-esc="line.price_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                    </div>
                                                    <!-- Lista de materiales -->
                                                    <t t-if="line.product_id.bom_count">
                                                        <t t-if="line.product_id.product_tmpl_id.bom_ids.to_print == True">
                                                            <t t-foreach="line.product_id.product_tmpl_id.bom_ids.bom_line_ids" t-as="bom_list">
                                                                <div style="width:10%;margin-left:4%;float:left;clear:both;">
                                                                    <i>
                                                                        <span t-esc="bom_list.product_id.default_code" />
                                                                    </i>
                                                                </div>
                                                                <div style="width:31.45%;float:left;">
                                                                    <i>
                                                                        <span t-esc="bom_list.product_id.name" />
                                                                    </i>
                                                                </div>
                                                                <div style="width:19.5%;float:left;text-align:right;">
                                                                    <i>
                                                                        <span t-esc="'%.2f'%bom_list.product_qty" />
                                                                    </i>
                                                                </div>
                                                            </t>
                                                        </t>
                                                    </t>
                                                    <!-- Fin Lista de materiales -->
                                                    <t t-if="o.sale_type_id.name != 'Serie C'">
                                                        <t t-foreach="line.invoice_line_tax_ids" t-as="tax">
                                                            <t t-set="tax_name" t-value="tax.name" />
                                                            <t t-set="isIVA" t-value="tax_name.find('IVA')" />
                                                            <!-- acumulacion de las cantidad de cada iva ventas -->
                                                            <!-- fin acumulaciones de las cantuidades de iva ventas -->
                                                        </t>
                                                    </t>
                                                    <!-- Fin precio total de linea -->
                                                </div>
                                            </t>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    <!-- fin lineas -->
                    <table class="table table-sm o_main_table" name="invoice_line_table" style="display:none;">
                        <thead>
                            <tr style="border-top: 2px solid black;border-bottom: 2px solid black;">
                                <th class="text-left">
                                    Código
                                </th>
                                <th class="text-left">
                                    Descripcion
                                </th>
                                <th class="text-center">
                                    IVA
                                </th>
                                <th class="text-center">
                                    Unidades
                                </th>
                                <th class="text-center">
                                    Precio
                                </th>
                                <th class="text-center" groups="sale.group_discount_per_so_line">
                                    <span>
                                        Dto.
                                    </span>
                                    <t t-set="colspan" />
                                </th>
                                <th class="text-right">
                                    <span>
                                        Neto
                                    </span>
                                </th>
                                <th class="text-right">
                                    <span>
                                        Importe
                                    </span>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody" style="border-bottom:4px solid black;">
                            <t t-set="current_subtotal" t-value="0" />
                            <t t-set="weight" t-value="0" />
                            <t t-foreach="o.invoice_line_ids" t-as="line">
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded" />
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included" />
                                <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                    <t t-if="not line.display_type" name="account_invoice_line_accountable">
                                        <!-- Codigo -->
                                        <td>
                                            <span t-field="line.product_id.default_code" />
                                        </td>
                                        <t t-set="weight" t-value="weight + line.product_id.weight * line.quantity" />
                                        <!-- FIn codigo -->
                                        <!-- Descripcion -->
                                        <td name="account_invoice_line_name">
                                            <span t-field="line.product_id.name" />
                                        </td>
                                        <!-- Fin descripcion -->
                                        <!-- IVA -->
                                        <td t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span t-esc="', '.join(map(lambda x: str(x.amount), line.invoice_line_tax_ids))" />
                                        </td>
                                        <!-- Fin IVA -->
                                        <!-- Unidades -->
                                        <td class="d-none">
                                            <span t-field="line.origin" />
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="'%.2f'%line.quantity" />
                                            <span t-field="line.uom_id" groups="uom.group_uom" />
                                        </td>
                                        <!-- Fin Unidades -->
                                        <!-- Precio -->
                                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span t-field="line.price_unit" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                        </td>
                                        <!-- Fin precio -->
                                        <!-- Descuento -->
                                        <t t-if="display_discount">
                                            <td t-if="display_discount" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                                <span t-field="line.discount" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td />
                                        </t>
                                        <!-- Fin descuento -->
                                        <!-- NETO -->
                                        <td class="text-right o_price_total">
                                            <span t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded" />
                                            <span t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included" />
                                        </td>
                                        <!-- Fin Neto -->
                                        <!-- Importe total -->
                                        <td class="text-right o_price_total">
                                            <span t-field="line.price_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                        </td>
                                        <!-- Fin importe total -->
                                    </t>
                                    <t t-if="line.display_type == 'line_section'">
                                        <td colspan="99">
                                            <span t-field="line.name" />
                                        </td>
                                        <t t-set="current_section" t-value="line" />
                                        <t t-set="current_subtotal" t-value="0" />
                                    </t>
                                    <t t-if="line.display_type == 'line_note'">
                                        <td colspan="99">
                                            <span t-field="line.name" />
                                        </td>
                                    </t>
                                </tr>
                                <t t-if="current_section and (line_last or o.invoice_line_ids[line_index+1].display_type == 'line_section')">
                                    <tr class="is-subtotal text-right">
                                        <td colspan="99">
                                            <strong class="mr16">
                                                Subtotal
                                            </strong>
                                            <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                    <!-- totales y calculos -->
                    <t t-set="importeIva" t-value="0" />
                    <t t-set="importeRecargo" t-value="0" />
                    <t t-foreach="o.amount_by_group" t-as="amount_by_group">
                        <t t-set="isIVA" t-value="amount_by_group[0].find('IVA')" />
                        <t t-if="isIVA == 0">
                            <t t-set="importeIva" t-value="importeIva + amount_by_group[1]" />
                        </t>
                        <t t-else="">
                            <t t-set="importeRecargo" t-value="importeRecargo + amount_by_group[1]" />
                        </t>
                    </t>
                    <div class="clearfix" style="display:none;">
                        <div id="total" class="row">
                            <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                                <table class="table table-sm">
                                    <tr class="border-black o_subtotal" style="">
                                        <td>
                                            <strong>
                                                Subtotal
                                            </strong>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="o.amount_untaxed" />
                                        </td>
                                    </tr>
                                    <t t-foreach="o.amount_by_group" t-as="amount_by_group">
                                        <tr style="">
                                            <t t-if="len(o.tax_line_ids) == 1 and o.amount_untaxed == amount_by_group[2]">
                                                <td>
                                                    <span t-esc="amount_by_group[0]" />
                                                </td>
                                                <td class="text-right o_price_total">
                                                    <span t-esc="amount_by_group[3]" />
                                                </td>
                                            </t>
                                            <t t-else="">
                                            </t>
                                        </tr>
                                    </t>
                                    <tr class="border-black o_total">
                                        <td>
                                            <strong>
                                                Total
                                            </strong>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="o.amount_total" />
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- desgloses IVA y RECARAGO  serie C -->
                    <t t-if="o.sale_type_id.name == 'Serie C'">
                        <div style="width:43%;float:right;font-size:0.7em;margin-top:-15px;">
                            <table style="border-bottom:4px solid black;">
                                <tr>
                                    <td style="solid; black; padding: 0px; margin: 0px; width:13%; !important;">
                                        <!-- base imponible sin descuentos -->
                                        <t t-if="o.amount_untaxed_before_global_discounts != 0">
                                            <div style="width:40%;float:left;">
                                                <span>
                                                    Bruto
                                                </span>
                                            </div>
                                            <div style="width:60%;float:left;text-align:right;">
                                                <span t-esc="o.amount_untaxed_before_global_discounts" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                            </div>
                                            <!-- Fin base imponible sin descuentos -->
                                        </t>
                                        <t t-else="">
                                            <!-- Base imponible -->
                                        </t>
                                        <!-- Fin base imponible -->
                                        <!-- Descuentos Globales -->
                                        <t t-set="amount_untaxed_before_global_discounts" t-value="o.amount_untaxed_before_global_discounts" />
                                        <t t-foreach="o.global_discount_ids" t-as="discount">
                                            <div t-if="o.amount_global_discount != 0" style="width:40%;float:left;clear:both;">
                                                <span t-esc="discount.name" />
                                                <span t-esc="discount.discount" />
                                                <span>
                                                    %
                                                </span>
                                            </div>
                                            <div t-if="o.amount_global_discount != 0" style="width:60%;float:left;text-align:right;">
                                                <t t-set="global_discount_line" t-value="(amount_untaxed_before_global_discounts * discount.discount / 100)" />
                                                <t t-set="amount_untaxed_before_global_discounts" t-value="amount_untaxed_before_global_discounts - global_discount_line" />
                                                <t t-set="discount_global" t-value="global_discount_line * -1" />
                                                <span t-esc="discount_global" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}">
                                                </span>
                                            </div>
                                        </t>
                                        <!-- Descuentos Globales -->
                                        <!-- Fin Descuentos Globales -->
                                        <!-- Base imponible -->
                                        <div style="width:40%;float:left;">
                                            <span>
                                                Base imponible
                                            </span>
                                        </div>
                                        <div style="width:60%;float:left;text-align:right;">
                                            <span t-esc="o.amount_untaxed" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                        </div>
                                        <!-- Fin base imponible -->
                                        <!-- Total -->
                                        <div style="width:40%;float:left;clear:both;">
                                            <b>
                                                <span>
                                                    Total
                                                </span>
                                            </b>
                                        </div>
                                        <div style="width:60%;float:left;text-align:right;">
                                            <b>
                                                <span t-esc="o.amount_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                            </b>
                                        </div>
                                        <!-- Fin Desglose -->
                                        <div style="clear:both;margin-top:5px;">
                                            <t t-set="noIva" t-value="1" />
                                            <!-- <p>*Exenta de IVA, según artículo 20, Ley 37/1992 de IVA.</p> -->
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                    <!-- Fin desgloses IVA y RECARAGO serie C -->
                    <!-- desgloses IVA y RECARAGO -->
                    <t t-if="o.sale_type_id.name != 'Serie C'">
                        <!-- Desglose -->
                        <div style="width:40%;margin-left:8%;float:right;font-size:0.7em;margin-top:-15px;margin-right:0.65%;">
                            <table style="border-bottom:4px solid black;">
                                <tr>
                                    <td style="solid; black; padding: 0px; margin: 0px; width:13%; !important;">
                                        <!-- Base imponible sin descuentos -->
                                        <t t-if="o.amount_global_discount != 0.00">
                                            <div style="width:50%;float:left;">
                                                <span>
                                                    Bruto
                                                </span>
                                            </div>
                                            <div style="width:50%;float:left;text-align:right;">
                                                <span t-esc="o.amount_untaxed_before_global_discounts" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                            </div>
                                            <!-- Fin base imponible sin descuentos -->
                                        </t>
                                        <t t-else="">
                                            <!-- Base imponible -->
                                        </t>
                                        <!-- Fin base imponible -->
                                        <!-- Descuentos Globales -->
                                        <t t-set="amount_untaxed_before_global_discounts" t-value="o.amount_untaxed_before_global_discounts" />
                                        <t t-foreach="o.global_discount_ids" t-as="discount">
                                            <div t-if="o.amount_global_discount != 0" style="width:50%;float:left;clear:both;">
                                                <span t-esc="discount.name" />
                                                <span t-esc="discount.discount" />
                                                <span>
                                                    %
                                                </span>
                                            </div>
                                            <div t-if="o.amount_global_discount != 0" style="width:50%;float:left;text-align:right;">
                                                <t t-set="global_discount_line" t-value="(amount_untaxed_before_global_discounts * discount.discount / 100)" />
                                                <t t-set="amount_untaxed_before_global_discounts" t-value="amount_untaxed_before_global_discounts - global_discount_line" />
                                                <t t-set="discount_global" t-value="global_discount_line * -1" />
                                                <span t-esc="discount_global" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}">
                                                </span>
                                            </div>
                                        </t>
                                        <!-- Descuentos Globales -->
                                        <!-- Fin Descuentos Globales -->
                                        <!-- Base imponible -->
                                        <div style="width:50%;float:left;">
                                            <span>
                                                Base imponible
                                            </span>
                                        </div>
                                        <div style="width:50%;float:left;text-align:right;">
                                            <span t-esc="o.amount_untaxed" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                        </div>
                                        <!-- Fin base imponible -->
                                        <!-- desglose de Impuestos -->
                                        <div style="clear:both;">
                                            <t t-foreach="o.amount_by_group" t-as="amount_by_group">
                                                <div style="">
                                                    <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                                        <t t-if="amount_by_group[2] &gt; 0">
                                                            <div>
                                                                <span t-esc="amount_by_group[0]" />
                                                                <span>
                                                                    en
                                                                </span>
                                                                <t t-esc="amount_by_group[2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                                <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                            </div>
                                                        </t>
                                                    </t>
                                                    <t t-else="">
                                                        <t t-if="amount_by_group[1] &gt; 0">
                                                            <div style="width:60%;float:left;">
                                                                <span t-esc="amount_by_group[0]" />
                                                                <span>
                                                                    en
                                                                </span>
                                                                <span t-esc="amount_by_group[2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                            </div>
                                                            <div style="width:40%;float:left;text-align:right;">
                                                                <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                                            </div>
                                                        </t>
                                                    </t>
                                                </div>
                                            </t>
                                        </div>
                                        <!-- Fin desglose impuestos -->
                                        <!-- Total -->
                                        <div style="width:50%;float:left;">
                                            <b>
                                                <span>
                                                    Total
                                                </span>
                                            </b>
                                        </div>
                                        <div style="width:50%;float:left;text-align:right;">
                                            <b>
                                                <span t-esc="o.amount_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}" />
                                            </b>
                                        </div>
                                        <!-- Fin Desglose -->
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                    <!-- Metodo de pago -->
                    <t t-if="o.payment_term_id">
                        <t t-set="plazos" t-value="o.payment_term_id.name" />
                    </t>
                    <!-- Fin metodo de pago -->
                    <!-- Leyenda Factura -->
                    <p t-if="o.fiscal_position_id.note" name="note">
                        <span t-field="o.fiscal_position_id.note" />
                    </p>
                    <div id="qrcode" t-if="(o.partner_id.country_id.code in ['BE', 'AT', 'DE', 'FI', 'NL']) and (o.company_id.qr_code) and (o.currency_id.name == 'EUR') and (o.partner_bank_id.acc_number != False)">
                        <p t-if="(o.partner_bank_id.qr_code_valid)">
                            <strong class="text-center">
                                Scan me with your banking app.
                            </strong>
                            <br />
                            <br />
                            <img class="border border-dark rounded" t-att-src="o.partner_bank_id.build_qr_code_url(o.residual,(o.reference) if (o.reference) else o.number)" />
                        </p>
                        <p t-if="(o.partner_bank_id.qr_code_valid == False)">
                            <strong class="text-center">
                                The SEPA QR Code informations are not set correctly.
                            </strong>
                            <br />
                        </p>
                    </div>
                    <!-- Inversion de sujeto pasivo -->
                    <t t-if="o.sale_type_id.name == 'Serie C'">
                        <!-- Porte y precio -->
                        <t t-set="PortPrice" t-value="0" />
                        <!-- Fin Porte y precios -->
                        <t t-foreach="o.invoice_line_ids" t-as="line">
                            <t t-if="line.product_id.default_code == 'ENT0'">
                                <t t-set="PortPrice" t-value="line.price_unit" />
                            </t>
                        </t>
                    </t>
                    <!-- Fin inversión del sujeto pasivo -->
                    </div>
                </t>
            </t>
		</template>
	</data>
</odoo>
